SET search_path to "$user", "order", public;SELECT * FROM lineitems_byflagandstatus_forshippeddate('1992/12/01')
SET search_path to stock, supplier, common; SELECT S_ACCTBAL ,S_NAME ,n_name ,P_PARTKEY ,P_MFGR ,S_ADDRESS ,S_PHONE ,S_COMMENT FROM PART ,SUPPLIER ,PARTSUPP ,NATION ,REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = $1 AND p_type LIKE $2 AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = $3 AND PS_SUPPLYCOST = ( SELECT MIN(PS_SUPPLYCOST) FROM PARTSUPP ,SUPPLIER ,NATION ,REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = N'EUROPE' ) ORDER BY S_ACCTBAL DESC ,n_name ,S_NAME ,P_PARTKEY LIMIT 100 \bind 50 '%NICKEL' 'EUROPE'
SET search_path to customer, "order"; SELECT L_ORDERKEY ,SUM(l_extendedprice*(1-l_discount)) AS REVENUE ,O_ORDERDATE ,O_SHIPPRIORITY FROM CUSTOMER ,ORDERS ,LINEITEM WHERE C_MKTSEGMENT = N'MACHINERY' AND C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE < DATE ($1) AND L_SHIPDATE > DATE ($1) GROUP BY L_ORDERKEY ,O_ORDERDATE ,O_SHIPPRIORITY ORDER BY REVENUE DESC ,O_ORDERDATE LIMIT 10 \bind '1995-03-21'
SET search_path to public, "order"; SELECT o_orderpriority ,COUNT(*) AS ORDER_COUNT FROM ORDERS WHERE O_ORDERDATE >= DATE ($1) AND O_ORDERDATE < DATE ($1) + INTERVAL '3' MONTH AND EXISTS ( SELECT * FROM LINEITEM WHERE L_ORDERKEY = O_ORDERKEY AND L_COMMITDATE < L_RECEIPTDATE ) GROUP BY o_orderpriority ORDER BY o_orderpriority \bind '1996-04-01'
SET search_path to "order", supplier, public, common, customer; SELECT n_name ,SUM(l_extendedprice*(1-l_discount)) AS REVENUE FROM CUSTOMER ,ORDERS ,LINEITEM ,SUPPLIER ,NATION ,REGION WHERE C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY AND L_SUPPKEY = S_SUPPKEY AND C_NATIONKEY = S_NATIONKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = $1 AND O_ORDERDATE >= DATE ($2) AND O_ORDERDATE < DATE ($2) + INTERVAL '1' YEAR GROUP BY n_name ORDER BY REVENUE DESC \bind 'EUROPE' '1997-01-01'
SET search_path to "order", "$user"; SELECT SUM(l_extendedprice*l_discount) AS REVENUE FROM LINEITEM WHERE L_SHIPDATE >= DATE ($1) AND L_SHIPDATE < DATE ($1) + INTERVAL '1' YEAR AND l_discount BETWEEN $2 - 0.01 AND $2 + 0.01 AND L_QUANTITY < $3 \bind '1997-01-01' '0.02' '25'
SET search_path to public, common, supplier, "order", customer; SELECT SUPP_NATION ,CUST_NATION ,L_YEAR ,SUM(VOLUME) AS REVENUE FROM ( SELECT N1.n_name AS SUPP_NATION ,N2.n_name AS CUST_NATION ,EXTRACT(YEAR FROM L_SHIPDATE) AS L_YEAR ,l_extendedprice*(1-l_discount) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION N1, NATION N2 WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = N1.N_NATIONKEY AND C_NATIONKEY = N2.N_NATIONKEY AND ( (N1.n_name = $1 AND N2.n_name = $2) OR (N1.n_name = $2 AND N2.n_name = $1) ) AND L_SHIPDATE BETWEEN DATE ($3) AND DATE ($4) ) AS SHIPPING GROUP BY SUPP_NATION ,CUST_NATION ,L_YEAR ORDER BY SUPP_NATION ,CUST_NATION ,L_YEAR \bind 'ALGERIA' 'RUSSIA' '1995-01-01' '1996-12-31'
SET search_path to customer, stock, supplier, "order", common; SELECT O_YEAR , SUM(CASE WHEN NATION = $1 THEN VOLUME ELSE 0 END) / SUM(VOLUME) AS MKT_SHARE FROM ( SELECT EXTRACT(YEAR FROM O_ORDERDATE) AS O_YEAR ,l_extendedprice * (1-l_discount) AS VOLUME ,N2.n_name AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION N1, NATION N2, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = N1.N_NATIONKEY AND N1.N_REGIONKEY = R_REGIONKEY AND R_NAME = $2 AND S_NATIONKEY = N2.N_NATIONKEY AND O_ORDERDATE BETWEEN DATE ($3) and DATE ($4) AND p_type = $5 ) ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR \bind 'RUSSIA' 'EUROPE' '01-01-95' '12-31-96' 'STANDARD POLISHED TIN'
SET search_path to customer, stock, supplier, "order", common; SELECT NATION ,O_YEAR ,SUM(AMOUNT) AS SUM_PROFIT FROM ( SELECT n_name AS NATION ,EXTRACT(YEAR FROM O_ORDERDATE) AS O_YEAR ,l_extendedprice*(1-l_discount)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY = L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY = L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE $1 ) AS PROFIT GROUP BY NATION ,O_YEAR ORDER BY NATION ,O_YEAR DESC \bind '%blush%'
SET search_path to "order", common, customer; SELECT C_CUSTKEY ,C_NAME ,SUM(l_extendedprice*(1-l_discount)) AS REVENUE ,C_ACCTBAL ,n_name ,C_ADDRESS ,C_PHONE ,C_COMMENT FROM CUSTOMER ,ORDERS ,LINEITEM ,NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= DATE ($1) AND O_ORDERDATE < DATE ($1) + INTERVAL '3' MONTH AND L_RETURNFLAG = $2 AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY ,C_NAME ,C_ACCTBAL ,C_PHONE ,n_name ,C_ADDRESS ,C_COMMENT ORDER BY REVENUE DESC LIMIT 20 \bind '1994-05-01' 'R'
SET search_path to stock, supplier, common; SELECT PS_PARTKEY ,SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP ,SUPPLIER ,NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND n_name = N'GERMANY' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > ( SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0000010000 FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND n_name = $1 ) ORDER BY VALUE DESC \bind 'GERMANY';
SET search_path to "order"; SELECT L_SHIPMODE ,SUM(CASE WHEN o_orderpriority = $1 OR o_orderpriority = $2 THEN 1 ELSE 0 END) AS HIGH_LINE_COUNT, SUM(CASE WHEN o_orderpriority <> $1 AND o_orderpriority <> $2 THEN 1 ELSE 0 END) AS LOW_LINE_COUNT FROM ORDERS ,LINEITEM WHERE O_ORDERKEY = L_ORDERKEY AND L_SHIPMODE IN ($3, $4) AND L_COMMITDATE < L_RECEIPTDATE AND L_SHIPDATE < L_COMMITDATE AND L_RECEIPTDATE >= DATE ($5) AND L_RECEIPTDATE < DATE ($5) + INTERVAL '1' YEAR GROUP BY L_SHIPMODE ORDER BY L_SHIPMODE \bind '1-URGENT' '2-HIGH' 'AIR' 'REG AIR' '1994-01-01'
SET search_path to "order", public, customer; SELECT C_COUNT, count(*) as CUSTDIST from ( select C_CUSTKEY, count(O_ORDERKEY) from CUSTOMER left outer join ORDERS on C_CUSTKEY = O_CUSTKEY and O_COMMENT not like $1 group by C_CUSTKEY ) as C_ORDERS (C_CUSTKEY, C_COUNT) group by C_COUNT order by CUSTDIST desc, C_COUNT desc \bind '%specialrequests%'
SET search_path to stock, "$user", "order"; SELECT 100.00 * SUM (CASE WHEN p_type LIKE $1 THEN l_extendedprice*(1-l_discount) ELSE 0 END ) / SUM(l_extendedprice*(1-l_discount)) AS PROMO_REVENUE FROM LINEITEM ,PART WHERE L_PARTKEY = P_PARTKEY AND L_SHIPDATE >= DATE ($2) AND L_SHIPDATE < DATE ($2) + INTERVAL '1' MONTH \bind 'PROMO%' '1994-05-01'
SET search_path to supplier, "order"; SELECT S_SUPPKEY ,S_NAME ,S_ADDRESS ,S_PHONE ,TOTAL_REVENUE FROM SUPPLIER ,(SELECT L_SUPPKEY AS SUPPLIER_NO , SUM(l_extendedprice*(1-l_discount)) AS TOTAL_REVENUE FROM LINEITEM WHERE L_SHIPDATE >= DATE ($1) AND L_SHIPDATE < DATE ($1) + INTERVAL '3' MONTH GROUP BY L_SUPPKEY)REVENUE WHERE S_SUPPKEY = SUPPLIER_NO AND TOTAL_REVENUE = ( SELECT MAX(TOTAL_REVENUE) FROM ( SELECT L_SUPPKEY AS SUPPLIER_NO, SUM(l_extendedprice*(1-l_discount)) AS TOTAL_REVENUE FROM LINEITEM WHERE L_SHIPDATE >= DATE ($1) AND L_SHIPDATE < DATE ($1) + INTERVAL '3' MONTH GROUP BY L_SUPPKEY ) REVENUE ) ORDER BY S_SUPPKEY \bind '1993-10-01'
SET search_path to stock, supplier; SELECT P_BRAND ,p_type ,P_SIZE ,COUNT(DISTINCT PS_SUPPKEY) AS SUPPLIER_CNT FROM PARTSUPP ,PART WHERE P_PARTKEY = PS_PARTKEY AND P_BRAND <> $1 AND p_type NOT LIKE $2 AND P_SIZE IN ($3, $4, $5, $6, $7, $8, $9, $10) AND PS_SUPPKEY NOT IN (SELECT S_SUPPKEY FROM SUPPLIER WHERE S_COMMENT LIKE $11 ) GROUP BY P_BRAND ,p_type ,P_SIZE ORDER BY SUPPLIER_CNT DESC ,P_BRAND ,p_type ,P_SIZE \bind 'Brand#54' 'MEDIUM BRUSHED%' 5 1 43 3 14 24 30 48 '%Customer%Complaints%'
SET search_path to "$user", public, "order", stock; SELECT sum(l_extendedprice* (1 - l_discount)) as REVENUE from LINEITEM, PART where ( P_PARTKEY = L_PARTKEY and P_BRAND = $1 and P_CONTAINER in ($2, $3, $4, $5) and L_QUANTITY >= $6 and L_QUANTITY <= $6 + 10 and P_SIZE between $7 and $8 and L_SHIPMODE in ($9, $10) and L_SHIPINSTRUCT = $11) or ( P_PARTKEY = L_PARTKEY and P_BRAND = $12 and P_CONTAINER in ($13, $14, $15, $16) and L_QUANTITY >= $17 and L_QUANTITY <= $17 + 10 and P_SIZE between $18 and $19 and L_SHIPMODE in ($9, $10) and L_SHIPINSTRUCT = $11) or ( P_PARTKEY = L_PARTKEY and P_BRAND = $20 and P_CONTAINER in ($21, $22, $23, $24) and L_QUANTITY >= $25 and L_QUANTITY <= $25 + 10 and P_SIZE between $26 and $27 and L_SHIPMODE in ($9, $10) and L_SHIPINSTRUCT = $11) \bind 'Brand#24' 'SM CASE' 'SM BOX' 'SM PACK' 'SM PKG' 7 1 5 'AIR' 'AIR REG' 'DELIVER IN PERSON' 'Brand#51' 'MED BAG' 'MED BOX' 'MED PKG' 'MED PACK' 15 1 10 '3' 'LG CASE' 'LG BOX' 'LG PACK' 'LG PKG' 27 1 15
SET search_path to stock, "order", public, common, supplier; SELECT S_NAME, S_ADDRESS from SUPPLIER, NATION where S_SUPPKEY in ( select PS_SUPPKEY from PARTSUPP where PS_PARTKEY in ( select P_PARTKEY from PART where P_NAME like $1 ) and PS_AVAILQTY > ( select 0.5 * sum(L_QUANTITY) from LINEITEM where L_PARTKEY = PS_PARTKEY and L_SUPPKEY = PS_SUPPKEY and L_SHIPDATE >= DATE ($2) and L_SHIPDATE < DATE ($2) + INTERVAL '1' YEAR ) ) and S_NATIONKEY = N_NATIONKEY and n_name = $3 order by S_NAME \bind 'purple%' '1997-01-01' 'CANADA'
SET search_path to "order", customer; SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN ( SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > $1 ) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100 \bind 313
SET search_path to stock, pubic, "order"; select sum(l_extendedprice* (1 - l_discount)) as REVENUE from LINEITEM, PART where ( P_PARTKEY = L_PARTKEY and P_BRAND = $1 and P_CONTAINER in ($2, $3, $4, $5) and L_QUANTITY >= $6 and L_QUANTITY <= $6 + 10 and P_SIZE between 1 and 5 and L_SHIPMODE in ($7, $8) and L_SHIPINSTRUCT = $9 ) or ( P_PARTKEY = L_PARTKEY and P_BRAND = $10 and P_CONTAINER in ($11, $12, $13, $14) and L_QUANTITY >= $15 and L_QUANTITY <= $15 + 10 and P_SIZE between 1 and 10 and L_SHIPMODE in ($7, $8) and L_SHIPINSTRUCT = $9 ) or ( P_PARTKEY = L_PARTKEY and P_BRAND = $16 and P_CONTAINER in ($17, $18, $19, $20) and L_QUANTITY >= $21 and L_QUANTITY <= $21 + 10 and P_SIZE between 1 and 15 and L_SHIPMODE in ($7, $8) and L_SHIPINSTRUCT = $9 ) \bind 'Brand#24' 'SM CASE' 'SM BOX' 'SM PACK' 'SM PKG' 7 'AIR' 'AIR REG' 'DELIVER IN PERSON' 'Brand#51' 'MED BAG' 'MED BOX' 'MED PKG' 'MED PACK' 15 '3' 'LG CASE' 'LG BOX' 'LG PACK' 'LG PKG' 27
SET search_path to public, "order", customer; select CNTRYCODE, count(*) as NUMCUST, sum(C_ACCTBAL) as TOTACCTBAL from ( select substring(C_PHONE,1,2) as CNTRYCODE, C_ACCTBAL from CUSTOMER where substring(C_PHONE,1,2) in ($1, $2, $3, $4, $5, $6, $7, $8) and C_ACCTBAL > ( select avg(C_ACCTBAL) from CUSTOMER where C_ACCTBAL > 0.00 and substring(C_PHONE,1,2) in ($1, $2, $3, $4, $5, $6, $7, $8) ) and not exists ( select * from ORDERS where O_CUSTKEY = C_CUSTKEY ) ) as CUSTSALE group by CNTRYCODE order by CNTRYCODE \bind '11' '13' '26' '27' '19' '24' '18' ''
--SET search_path to "order", public, common, supplier; --select S_NAME, count(*) as NUMWAIT from SUPPLIER, LINEITEM L1, ORDERS, NATION where S_SUPPKEY = L1.L_SUPPKEY and O_ORDERKEY = L1.L_ORDERKEY and O_ORDERSTATUS = $1 and L1.L_RECEIPTDATE > L1.L_COMMITDATE and exists ( select * from LINEITEM L2 where L2.L_ORDERKEY = L1.L_ORDERKEY and L2.L_SUPPKEY <> L1.L_SUPPKEY ) and not exists ( select * from LINEITEM L3 where L3.L_ORDERKEY = L1.L_ORDERKEY and L3.L_SUPPKEY <> L1.L_SUPPKEY and L3.L_RECEIPTDATE > L3.L_COMMITDATE ) and S_NATIONKEY = N_NATIONKEY and n_name = $2 group by S_NAME order by NUMWAIT desc, S_NAME LIMIT 100 \bind 'F' 'UNITED STATES'
